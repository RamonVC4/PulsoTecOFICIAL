<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acceder - PULSOTEC</title>
    <link rel="stylesheet" href="../styles/styles_login.css">
</head>
<body class="login-page">
    <main class="login-container">
        <section class="card" role="region" aria-labelledby="login-title">
            <h1 id="login-title" class="card-title">REGISTRO</h1>

            <!-- <form class="login-form" action="login.php" method="post" autocomplete="on" novalidate> -->
            <form class="login-form" autocomplete="on" novalidate>
                <!-- Role switcher (submits with the form) -->
                <div class="role-switch" role="tablist" aria-label="Seleccionar rol">
                    <input type="radio" id="role-autor" name="role" value="autor">
                    <input type="radio" id="role-revisor" name="role" value="revisor" checked>

                    <div class="tabs">
                        <label class="tab" for="role-autor" role="tab" aria-controls="tabpanel" aria-selected="false">AUTOR</label>
                        <label class="tab" for="role-revisor" role="tab" aria-controls="tabpanel" aria-selected="true">REVISOR</label>
                        <span class="pill" aria-hidden="true"></span>
                    </div>
                </div>

                <div id="tabpanel" class="form-fields" role="tabpanel" tabindex="-1">
                    <div style="visibility: collapse;" id="curpDiv">
                        <label for="curp">CURP</label>
                        <input id="curp" name="curp" type="text" inputmode="text" autocomplete="curp" placeholder="Ingresa tu CURP">
                    </div>
                    <div class="field">
                        <label for="correo">Correo</label>
                        <input id="correo" name="correo" type="text" inputmode="text" autocomplete="correo" required placeholder="Ingresa tu correo">
                    </div>

                    <div class="field password-field">
                        <label for="password">Contraseña</label>
                        <div class="password-field_with-icon">

                            <input id="password" name="password" type="password" autocomplete="current-password" required placeholder="Ingresa tu contraseña">

                            <button type="button" class="toggle-password" aria-label="Mostrar u ocultar contraseña" aria-controls="password">
                                <!-- SVG -->
                                <svg class="icon-eye" viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                                    <path d="M1 12s4-7 11-7 11 7 11 7-4 7-11 7-11-7-11-7z"></path>
                                    <circle cx="12" cy="12" r="3"></circle>
                                </svg>
                            </button>
                        </div>
                        
                    </div>
                </div>

                <div class="actions">
                    <button type="button" class="btn-primary" onclick="registrar()">REGISTRAR</button>
                    <a class="link-ghost" href="./login.html" aria-label="Crear cuenta nueva">YA TENGO CUENTA</a>
                </div>
            </form>
        </section>
    </main>

    <footer class="brand-footer" aria-hidden="true">
        <span>P u l s o T e c&nbsp;&nbsp;V e r i f i c a</span>
    </footer>



    
<script>
(function () {
    const toggle = document.querySelector('.toggle-password');
    const pwd = document.getElementById('password');
    if (toggle && pwd) {
        toggle.addEventListener('click', function () {
            const reveal = pwd.type === 'password';
            pwd.type = reveal ? 'text' : 'password';
            toggle.classList.toggle('revealed', reveal);
            pwd.focus({ preventScroll: true });
        });
    }
})();
</script>
<script>
    addEventListener('DOMContentLoaded', () => {
        console.log('DOM cargado');
        document.querySelectorAll('input[name="role"]').forEach(input => input.addEventListener('change', () => {
        console.log(document.querySelector('input[name="role"]:checked').value);
        if (document.querySelector('input[name="role"]:checked').value === 'revisor') {
            console.log('revisor');
            const curpDiv = document.querySelector('#curpDiv');
            curpDiv.classList.remove('hidden');
            curpDiv.attributes['style'].value = 'visibility: visible;';
        }else{
            console.log('autor');
            const curpDiv = document.querySelector('#curpDiv');
            curpDiv.classList.add('hidden');
            curpDiv.attributes['style'].value = 'visibility: collapse;';
        }
        
        
        })); 
    })
</script>
<script>
    async function registrar() {
        //consigo los datos de los campos y los verifico
        //correo
        const correo = document.getElementById('correo').value;
        if (!correo.isValidEmail()) {
            alert("Por favor ingresa un correo valido.");
            return;
        }

        //password
        const password = document.getElementById('password').value;
        if (!password.lenght >= 6){
            alert("La contraseña debe tener al menos 6 caracteres.");
            return;
        }
        
        //si es revisor leo aparte la CURP
        if (document.querySelector('input[name="role"]:checked').value === 'revisor') {
            
            const curp = document.getElementById('curp').value;    
            //valido la curp TODO ME GUSTARIA USAR RENAPO PERO NO TIENE API
            const regexCurp = /^[A-Z]{1}[AEIOU]{1}[A-Z]{2}\d{2}(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])[HM]{1}(AS|BC|BS|CC|CL|CM|CS|CH|DF|DG|GT|GR|HG|JC|MC|MN|MS|NT|NL|OC|PL|QT|QR|SP|SL|SR|TC|TS|VZ|YN|ZS|NE)[B-DF-HJ-NP-TV-Z]{3}[A-Z\d]{1}\d{1}$/;

            if (!regexCurp.test(curp)) {
                alert("CURP no válida, por favor verifique.");
                return;
            }
        }


        

        //valido el email
            //si es valido, lo envio al backend
            //si no es valido, muestro error
    }
</script>
</body>
</html>

